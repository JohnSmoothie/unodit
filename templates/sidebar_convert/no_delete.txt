class test(unohelper.Base,XDispatch,XDispatchProvider):

${I}IMPLE_NAME = "${EXTENSION_IDENTIFIER}.${SIDEBAR_PROTOCOL}"
${I}SERVICE_NAMES = IMPLE_NAME,

${I}@classmethod
${I}def get_imple(klass):
${I}${I}#pydevBrk()
${I}${I}return klass, klass.IMPLE_NAME, klass.SERVICE_NAMES

${I}def __init__(self,*args):
${I}${I}pass

${I}def queryDispatches(self,*args):
${I}${I}return

${I}def queryDispatch(self,featureURL,frameName,searchFlag):
${I}${I}return self

${I}def dispatch(self,featureURL,args):
${I}${I}self.do_something(featureURL)

${I}def addStatusListener(self,listener,featureURL):
${I}${I}#print('addStatusListener', featureURL.Path)
${I}${I}return

${I}def removeStatusListener(self,listener,featureURL):
${I}${I}#print('removeStatusListener', featureURL.Path)
${I}${I}return

${I}def do_something(self,featureURL):

${I}${I}ctx = uno.getComponentContext()
${I}${I}desktop = ctx.ServiceManager.createInstanceWithContext( "com.sun.star.frame.Desktop",ctx)
${I}${I}doc = desktop.getCurrentComponent()
${I}${I}text = doc.Text

${I}${I}cur = text.createTextCursor()
${I}${I}cur.gotoEnd(False)
${I}${I}t = 'Hello from your command ' + featureURL.Path
${I}${I}text.insertString(cur,t,False)

g_ImplementationHelper.addImplementation(*test.get_imple())
